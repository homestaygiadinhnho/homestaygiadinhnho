---
layout: 
title: "Karaoke Sao Mai"
permalink: /saomai
description: "Sao Mai Media - Nơi bạn thăng hoa cảm xúc với dịch vụ Karaoke đẳng cấp."
---

<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Karaoke với YouTube</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    @font-face {
      font-family: saomaiMedia;
      font-style: normal;
      font-display: swap;
      src: url(https://homestaygiadinhnho.github.io/assets/fonts/SpotifyMixUI-Regular.woff2) format("woff2");
      font-weight: 400;
    }

    @font-face {
      font-family: saomaiMedia;
      font-style: normal;
      font-display: swap;
      src: url(https://homestaygiadinhnho.github.io/assets/fonts/SpotifyMixUITitle-Bold.woff2) format("woff2");
      font-weight: 700;
    }

    @font-face {
      font-display: swap;
      font-family: ui-icons;
      src: url(https://homestaygiadinhnho.github.io/assets/fonts/ui-icons.woff2) format("woff2");
    }

    .ld {
      -moz-osx-font-smoothing: grayscale;
      -webkit-font-smoothing: antialiased;
      display: inline-block;
      font: normal normal normal 16px / 1 ui-icons;
      font-size: inherit;
    }

    .ld.ld-Play:before {
      content: "\f19a";
    }

    .ld.ld-Selected:before {
      content: "\f1a9";
    }

    .ld.ld-Heart:before {
      content: "\f168";
    }

    .ld.ld-Service:before {
      content: "\f1b3";
    }

    .ld.ld-Ads:before {
      content: "\f16c";
    }

    .line-clamp-2 {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      overflow: hidden;
      min-height: 1.75rem;
      /* Chiều cao tối thiểu */
      max-height: 3.5rem;
      /* Chiều cao tối đa */
    }

    body {
      font-family: saomaiMedia;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: #2d3748;
      /* Màu nền tối */
      color: white;
      /* Màu chữ trắng */
      display: flex;
      justify-content: space-around;
      padding: 1rem;
      /* Padding cho phần tử */
      box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.3);
      /* Đổ bóng */
    }

    .bottom-nav div {
      text-align: center;
      /* Căn giữa nội dung */
    }

    .bottom-nav i {
      font-size: 24px;
      /* Kích thước icon */
      margin-bottom: 0.25rem;
      /* Khoảng cách giữa icon và chữ */
    }

    .badge-shape-wiz__text {
      background: rgba(0, 0, 0, 0.9);
      font-weight: 700;
      padding: 0 4px;
    }
#videoList > div:first-child {
    margin-top: 24px; /* Đặt margin-top cho videoItem đầu tiên */
}

#videoList > div:last-child {
    margin-bottom: 92px; /* Đặt margin-bottom cho videoItem cuối cùng */
}
  </style>
<script>
  // Khởi tạo Supabase
  const supabaseUrl = 'https://wndajplczagmlxbvkmtk.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InduZGFqcGxjemFnbWx4YnZrbXRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjgwMTUzNDcsImV4cCI6MjA0MzU5MTM0N30.1ffeOEC-jOQtar3tgD8OPBUeyK79itCPYmBe3_k08MA';
  const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

  // Hàm tìm kiếm video
  async function searchVideos() {
    const query = document.getElementById('searchInput').value;
    const apiKey = 'AIzaSyDXo9tP0rycwrE4tpXokP1AggTRP7Zt2B4';
    const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=20&q=${query}+karaoke&type=video&key=${apiKey}`;
    try {
      const response = await fetch(url);
      const data = await response.json();
      const videoList = document.getElementById('videoList');
      videoList.innerHTML = ''; // Xóa danh sách video cũ

      // Lấy videoIds để tìm thêm thông tin từ video API
      const videoIds = data.items.map(item => item.id.videoId).join(',');
      const videoDetailsUrl = `https://www.googleapis.com/youtube/v3/videos?part=contentDetails,statistics&id=${videoIds}&key=${apiKey}`;
      const videoDetailsResponse = await fetch(videoDetailsUrl);
      const videoDetailsData = await videoDetailsResponse.json();

      // Hiển thị thông tin video
      data.items.forEach((item, index) => {
        const videoId = item.id.videoId;
        const title = item.snippet.title;
        const channelTitle = item.snippet.channelTitle;
        const thumbnailUrl = item.snippet.thumbnails.medium.url;
        const channelId = item.snippet.channelId;
        const publishedAt = item.snippet.publishedAt;
        const channelThumbnailUrl = item.snippet.thumbnails.default.url;

        // Thông tin chi tiết từ videoDetailsData
        const viewCount = videoDetailsData.items[index].statistics.viewCount;
        const duration = formatDuration(videoDetailsData.items[index].contentDetails.duration);

        // Tạo video item
        const videoItem = document.createElement('div');
        videoItem.classList.add('rounded', 'cursor-pointer', 'flex', 'w-full', 'flex-col');

        // Tạo phần hình ảnh (thumbnail)
        const thumbnailContainer = document.createElement('div');
        thumbnailContainer.classList.add('relative');
        const thumbnail = document.createElement('img');
        thumbnail.src = thumbnailUrl;
        thumbnail.classList.add('w-full', 'h-60');
        thumbnail.style.objectFit = 'cover';

        // Tạo badge cho thời gian
        const durationOverlay = document.createElement('div');
        durationOverlay.classList.add('thumbnail-overlay-badge-shape', 'absolute', 'bottom-0', 'right-0', 'm-2');
        const badgeText = document.createElement('div');
        badgeText.classList.add('badge-shape-wiz__text');
        badgeText.textContent = duration;
        durationOverlay.appendChild(badgeText);

        thumbnailContainer.appendChild(thumbnail);
        thumbnailContainer.appendChild(durationOverlay);

        // Tạo phần avatar và thông tin video
        const avatarContainer = document.createElement('div');
        avatarContainer.classList.add('flex', 'items-center');
        avatarContainer.style.margin = '8px 0 0 16px';

        const avatar = document.createElement('img');
        avatar.src = channelThumbnailUrl;
        avatar.classList.add('rounded-full', 'w-10', 'h-10');
        avatar.style.objectFit = 'cover';

        const videoInfo = document.createElement('div');
        videoInfo.classList.add('ml-3', 'text-left');
        videoInfo.innerHTML = `
          <p class="text-white font-bold text-xl line-clamp-2">${title}</p>
          <p class="text-gray-400 text-sm">${channelTitle} • ${formatViews(viewCount)} • ${formatDate(publishedAt)}</p>
        `;

        avatarContainer.appendChild(avatar);
        avatarContainer.appendChild(videoInfo);

        // Nút chọn bài hát
        const selectButton = document.createElement('button');
        selectButton.textContent = "Tôi chọn hát bài này";
        selectButton.classList.add('bg-green-500', 'hover:bg-green-400', 'p-2', 'rounded-sm', 'text-white', 'mt-2', 'font-bold');
        selectButton.style.margin = '8px 16px';
        selectButton.style.background = 'brown';
        selectButton.onclick = () => handleSongSelection(videoId, title);

        // Thêm nút và các phần khác vào videoItem
        videoItem.appendChild(thumbnailContainer);
        videoItem.appendChild(avatarContainer);
        videoItem.appendChild(selectButton);

        // Thêm videoItem vào videoList
        videoList.appendChild(videoItem);

        // Đặt margin-bottom cho video cuối cùng
        if (videoList.children.length === data.items.length) {
          videoItem.style.marginBottom = '92px';
        }
      });
    } catch (error) {
      console.error('Error fetching video data:', error);
    }
  }

  // Hàm xử lý chọn bài hát
  function handleSongSelection(videoId, title) {
    const name = prompt("Nhập tên của bạn:");
    const age = prompt("Nhập tuổi của bạn:");

    if (name && age) {
      saveSong(videoId, name, age)
        .then(() => {
          // Chuyển hướng đến trang chọn bài
          window.location.href = 'https://homestaygiadinhnho.github.io/chonbai';
        })
        .catch((error) => {
          alert("Đã xảy ra lỗi khi lưu thông tin. Vui lòng thử lại.");
          console.error('Error saving song:', error);
        });
    } else {
      alert("Bạn phải nhập đầy đủ tên và tuổi!");
    }
  }

  // Hàm lưu thông tin bài hát vào Supabase
  async function saveSong(videoId, name, age) {
    try {
      const { data, error } = await supabaseClient
        .from('karaoke_songs')
        .insert([{ video_id: videoId, name: name, age: age }]);

      if (error) throw error;

      console.log('Song saved:', data);
    } catch (error) {
      console.error('Error saving song:', error);
    }
  }

  // Hàm định dạng số lượt xem
  function formatViews(views) {
    const viewCount = parseInt(views, 10);
    if (viewCount >= 1e6) {
      return `${(viewCount / 1e6).toFixed(1)} Tr lượt xem`;
    } else if (viewCount >= 1e3) {
      return `${(viewCount / 1e3).toFixed(1)} N lượt xem`;
    } else {
      return `${viewCount} lượt xem`;
    }
  }

  // Hàm định dạng ngày đăng
  function formatDate(publishedAt) {
    const publishedDate = new Date(publishedAt);
    const now = new Date();
    const diffTime = Math.abs(now - publishedDate);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

    if (diffDays < 30) {
      return `${diffDays} ngày trước`;
    } else if (diffDays < 365) {
      return `${Math.floor(diffDays / 30)} tháng trước`;
    } else {
      return `${Math.floor(diffDays / 365)} năm trước`;
    }
  }

  // Hàm định dạng thời gian (ISO 8601 duration)
  function formatDuration(duration) {
    let hours = 0,
      minutes = 0,
      seconds = 0;
    duration = duration.replace('PT', '');

    if (duration.indexOf('H') > -1) {
      let split = duration.split('H');
      hours = parseInt(split[0], 10);
      duration = split[1];
    }

    if (duration.indexOf('M') > -1) {
      let split = duration.split('M');
      minutes = parseInt(split[0], 10);
      duration = split[1];
    }

    if (duration.indexOf('S') > -1) {
      seconds = parseInt(duration.replace('S', ''), 10);
    }

    if (hours > 0) {
      minutes += hours * 60;
    }

    const formattedMinutes = String(minutes).padStart(2, '0');
    const formattedSeconds = String(seconds).padStart(2, '0');
    return `${formattedMinutes}:${formattedSeconds}`;
  }
</script>

</head>

<body class="bg-black text-white mx-auto container" style="max-width:720px;">
  <div class="text-center">
    <h1 class="text-4xl font-bold mb-6 hidden">Karaoke với YouTube</h1>

    <div class="flex justify-center items-center w-full px-4" style="padding: 12px 16px;background: brown;">
      <div class="relative w-full max-w-full">
        <!-- Biểu tượng tìm kiếm -->
        <div class="absolute inset-y-0 left-0 p-3 flex items-center pointer-events-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 16 16" fill="currentColor">
            <path d="M7 1.75a5.25 5.25 0 1 0 0 10.5 5.25 5.25 0 0 0 0-10.5zM.25 7a6.75 6.75 0 1 1 12.096 4.12l3.184 3.185a.75.75 0 1 1-1.06 1.06L11.304 12.2A6.75 6.75 0 0 1 .25 7z"></path>
          </svg>
        </div>

        <!-- Trường nhập liệu -->
        <input type="text" id="searchInput" autocomplete="off" placeholder="Bạn muốn hát bài gì?" class="p-3 pl-12 pr-14 w-full h-11 text-white text-xl font-bold rounded-full border-1 border-gray-300" onkeydown="if(event.key === 'Enter') searchVideos()" style="background:black;padding:8px 44px;border:none;border-radius:4px;">
      </div>
    </div>

    <div id="videoList" class="flex justify-center items-center w-full flex-col gap-6"></div>

    <!-- Giao diện hiển thị bài hát karaoke -->

    <!-- Giao diện xem các bài hát đã chọn -->
  </div>
  <script src="https://www.youtube.com/iframe_api"></script>

  <div class="fixed bottom-0 left-0 right-0 bg-black text-white flex justify-between p-4 shadow-lg" style="background: brown;max-width: 720px; margin: 0 auto;">
    <button class="flex flex-col items-center">
      <i class="ld ld-Play" style="font-size:1rem;vertical-align:-0.175em;width:16px;height:1rem;box-sizing:content-box" aria-hidden="true"></i>
      <span class="font-bold text-xs mt-1">Đang hát</span>
    </button>
    <button class="flex flex-col items-center">
      <i class="ld ld-Selected" style="font-size:1rem;vertical-align:-0.175em;width:16px;height:1rem;box-sizing:content-box" aria-hidden="true"></i>
      <span class="font-bold text-xs mt-1">Đã chọn</span>
    </button>
    <button class="flex flex-col items-center">
      <i class="ld ld-Heart" style="font-size:1rem;vertical-align:-0.175em;width:16px;height:1rem;box-sizing:content-box" aria-hidden="true"></i>
      <span class="font-bold text-xs mt-1">Thả tim</span>
    </button>
    <button class="flex flex-col items-center">
      <i class="ld ld-Service" style="font-size:1rem;vertical-align:-0.175em;width:16px;height:1rem;box-sizing:content-box" aria-hidden="true"></i>
      <span class="font-bold text-xs mt-1">Dịch vụ</span>
    </button>
    <button class="flex flex-col items-center">
      <i class="ld ld-Ads" style="font-size:1rem;vertical-align:-0.175em;width:16px;height:1rem;box-sizing:content-box" aria-hidden="true"></i>
      <span class="font-bold text-xs mt-1">Quảng cáo</span>
    </button>
  </div>

</body>

</html>
